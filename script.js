/* ====== ДАННЫЕ КАТАЛОГА: категории + подкатегории ====== */
const CATEGORIES = [
  {
    emoji: "🏠",
    title: "Бытовые услуги",
    subs: [
      "Ремонт и уборка квартир",
      "Клининговые услуги",
      "Сантехника, электрика",
      "Мелкий бытовой ремонт (мебель, техника)",
      "Услуги няни, сиделки",
      "Химчистка одежды, ковров",
      "Уборка квартир, домов, офисов",
      "Генеральная уборка, химчистка мебели/ковров",
      "Сантехнические работы (установка, ремонт)",
      "Электромонтажные работы",
      "Ремонт и сборка мебели",
      "Ремонт бытовой техники",
      "Чистка вентиляции",
      "Услуги гувернантки",
      "Помощь по хозяйству"
    ]
  },
  {
    emoji: "🛠",
    title: "Ремонт и строительство",
    subs: [
      "Ремонт квартир «под ключ»",
      "Малярные, штукатурные, плиточные работы",
      "Строительство домов, дач, бань",
      "Дизайн интерьеров, архитектурное проектирование",
      "Ландшафтный дизайн",
      "Монтаж окон, дверей",
      "Изготовление мебели на заказ",
      "Кровельные работы, фасады",
      "Сварочные работы",
      "Строительство заборов, беседок"
    ]
  },
  {
    emoji: "🚗",
    title: "Авто и транспорт",
    subs: [
      "Такси",
      "Грузоперевозки",
      "Услуги эвакуатора",
      "Переезды «под ключ»",
      "Курьерская доставка",
      "Ремонт автомобилей (СТО)",
      "Шиномонтаж, автомойка",
      "Чип-тюнинг, автодиагностика",
      "Аренда авто с водителем"
    ]
  },
  {
    emoji: "📦",
    title: "Переезды и доставка",
    subs: [
      "Грузчики",
      "Газель/микроавтобус",
      "Сборка и разборка мебели",
      "Переезды квартир и офисов",
      "Доставка товаров и еды",
      "Курьерские услуги по городу"
    ]
  },
  {
    emoji: "🧰",
    title: "Технические услуги",
    subs: [
      "Ремонт телефонов, ноутбуков, техники",
      "Настройка интернета, компьютеров",
      "Установка и настройка ПО",
      "Установка видеонаблюдения, сигнализаций",
      "Сборка и апгрейд ПК",
      "Кибербезопасность, резервное копирование"
    ]
  },
  {
    emoji: "👩‍💻",
    title: "Онлайн-услуги (фриланс)",
    subs: [
      "Копирайтинг, рерайтинг, переводы",
      "Ведение соцсетей (SMM, таргетинг, дизайн постов)",
      "Дизайн (логотипы, сайты, презентации)",
      "Программирование, создание сайтов, мобильных приложений",
      "Онлайн-репетиторство, консультации",
      "Администрирование маркетплейсов (Wildberries, Ozon и др.)"
    ]
  },
  {
    emoji: "🌐",
    title: "Онлайн и IT",
    subs: [
      "Создание сайтов, интернет-магазинов",
      "Поддержка и администрирование сайтов",
      "SEO-продвижение",
      "Контекстная реклама, таргетинг",
      "Ведение социальных сетей (SMM)",
      "Графический дизайн, UX/UI",
      "Программирование, автоматизация",
      "Настройка и сопровождение CRM",
      "Облачные сервисы, кибербезопасность",
      "Создание чат-ботов"
    ]
  },
  {
    emoji: "👩‍⚕️",
    title: "Медицинские и оздоровительные услуги",
    subs: [
      "Консультации врачей",
      "Массаж, косметология, маникюр, парикмахер",
      "Фитнес-тренер, йога, ЛФК",
      "Диетолог, нутрициолог",
      "Диагностика (УЗИ, ЭКГ, анализы)",
      "Стоматология",
      "Психолог, психотерапевт, коуч",
      "Реабилитация, ЛФК",
      "Ветеринарные услуги"
    ]
  },
  {
    emoji: "📚",
    title: "Образовательные услуги",
    subs: [
      "Репетиторство (школьные предметы, языки)",
      "Курсы (компьютерные, творческие, профподготовка)",
      "Танцы, вокал, музыка",
      "Детские кружки и секции",
      "Онлайн-обучение, вебинары"
    ]
  },
  {
    emoji: "🎉",
    title: "Ивент и развлечения",
    subs: [
      "Организация мероприятий (свадьбы, дни рождения, корпоративы)",
      "Фото- и видеосъёмка",
      "Ведущие, аниматоры",
      "Декораторы, флористы",
      "Аренда оборудования (сцены, свет, звук)"
    ]
  },
  {
    emoji: "💼",
    title: "Бизнес-услуги",
    subs: [
      "Юридические услуги",
      "Бухгалтерия и налоговый учёт",
      "Консалтинг (бизнес, маркетинг, HR)",
      "Регистрация фирм, лицензии",
      "Рекламные услуги",
      "Брендинг и продвижение",
      "Кадровые агентства, рекрутинг",
      "Переводческие услуги"
    ]
  },
  {
    emoji: "✈️",
    title: "Туризм и отдых",
    subs: [
      "Туристические агентства",
      "Гиды, экскурсоводы",
      "Бронирование билетов и гостиниц",
      "Организация туров по Кыргызстану",
      "Аренда квартир/домов посуточно",
      "Прокат спортинвентаря, велосипедов, авто"
    ]
  },
  {
    emoji: "🐾",
    title: "Услуги для животных",
    subs: [
      "Ветеринар",
      "Груминг (стрижка, уход)",
      "Передержка животных",
      "Дрессировка собак",
      "Продажа и доставка кормов"
    ]
  },
  {
    emoji: "🛒",
    title: "Разное",
    subs: [
      "Фото на документы",
      "Ксерокопии, печать, ламинация",
      "Доставка цветов и подарков",
      "Ремонт телефонов, ноутбуков",
      "Настройка интернета, телевидения",
      "Установка камер наблюдения",
      "Курсы первой помощи",
      "Аренда инструментов, техники"
    ]
  }
];

/* ====== ССЫЛКИ НА DOM ====== */
const grid = document.getElementById('categoriesGrid');
const searchInput = document.getElementById('searchInput');
const modal = document.getElementById('modal');
const modalTitle = document.getElementById('modalTitle');
const modalChips = document.getElementById('modalChips');
const modalClose = document.getElementById('modalClose');
const modalClose2 = document.getElementById('modalClose2');

/* ====== РЕНДЕР КАРТОЧЕК КАТЕГОРИЙ ====== */
function renderGrid(items){
  grid.innerHTML = '';
  items.forEach(cat => {
    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      <div class="emoji">${cat.emoji}</div>
      <div class="card-body">
        <h3>${cat.title}</h3>
        <p>${cat.subs.slice(0,3).join(' · ')}</p>
        <div class="chipbar">
          ${cat.subs.slice(0,6).map(s=>`<span class="chip" data-open="${cat.title}" title="Показать все">${s}</span>`).join('')}
        </div>
        <div class="more">
          <button class="more-btn" data-open="${cat.title}">Смотреть подкатегории</button>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
}

/* ====== МОДАЛКА С ПОДКАТЕГОРИЯМИ ====== */
function openModal(title){
  const cat = CATEGORIES.find(c=>c.title===title);
  if(!cat) return;
  modalTitle.textContent = cat.title;
  modalChips.innerHTML = cat.subs
    .map(s => `<span class="chip" data-clipboard="${s}" title="Нажмите, чтобы скопировать">${s}</span>`)
    .join('');
  modal.classList.remove('hidden');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';
}
function closeModal(){
  modal.classList.add('hidden');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow = '';
}

/* клики по карточкам/чипсам */
grid.addEventListener('click', (e)=>{
  const openEl = e.target.closest('[data-open]');
  if(openEl){ openModal(openEl.dataset.open); }
});
modal.addEventListener('click', (e)=>{
  if(e.target.classList.contains('modal-backdrop')) closeModal();
});
modalClose?.addEventListener('click', closeModal);
modalClose2?.addEventListener('click', closeModal);

/* ====== ПОИСК ПО НАЗВАНИЮ И ПОДКАТЕГОРИЯМ ====== */
function handleSearch(q){
  const s = q.trim().toLowerCase();
  if(!s){ renderGrid(CATEGORIES); return; }
  const filtered = CATEGORIES.filter(c =>
    c.title.toLowerCase().includes(s) ||
    c.subs.some(x => x.toLowerCase().includes(s))
  );
  renderGrid(filtered);
}

/* ====== СТАРТ ====== */
renderGrid(CATEGORIES);
searchInput?.addEventListener('input', (e)=> handleSearch(e.target.value));`  a2
